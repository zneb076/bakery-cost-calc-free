import{r,w as k,c as _,a as d,o as c,b as x,d as B,F as A,e as C,x as D,f as F,t as O}from"./index-bbRvvdfe.js";const L={class:"relative"},E=["value","placeholder"],I={key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-y-auto rounded-md border border-gray-300 bg-white shadow-lg"},M=["onMousedown"],z={__name:"CustomAutocomplete",props:{modelValue:[String,Number],options:{type:Array,default:()=>[]},creatable:{type:Boolean,default:!1},placeholder:{type:String,default:"ค้นหาหรือเลือก"},showAllOnFocus:{type:Boolean,default:!0}},emits:["update:modelValue","selection-made"],setup(i,{expose:v,emit:h}){const e=i,u=h,p=r(e.modelValue||""),o=r(!1),f=r(null),t=r(-1);k(()=>e.modelValue,a=>{p.value=a});const s=_(()=>(t.value=-1,p.value?e.options.filter(a=>a.toLowerCase().includes(p.value.toLowerCase())):e.showAllOnFocus?e.options:[]));function m(a){u("update:modelValue",a),o.value=!1,u("selection-made")}function w(a){u("update:modelValue",a.target.value),o.value=!0}function y(){setTimeout(()=>{!e.creatable&&e.modelValue&&!e.options.includes(e.modelValue)&&u("update:modelValue",""),o.value=!1},200)}function b(a){const l=s.value.length;switch(a.key){case"ArrowDown":if(!l)return;a.preventDefault(),t.value=(t.value+1)%l;break;case"ArrowUp":if(!l)return;a.preventDefault(),t.value=(t.value-1+l)%l;break;case"Enter":a.preventDefault(),t.value!==-1&&l>0?m(s.value[t.value]):(!e.creatable&&e.modelValue&&!e.options.includes(e.modelValue)&&u("update:modelValue",""),o.value=!1,u("selection-made"));break;case"Escape":o.value=!1;break}}function V(){f.value?.focus()}return v({focus:V}),(a,l)=>(c(),d("div",L,[x("input",{ref_key:"inputRef",ref:f,type:"text",value:i.modelValue,placeholder:i.placeholder,onInput:w,onFocus:l[0]||(l[0]=n=>o.value=!0),onBlur:y,onKeydown:b,class:"w-full rounded-md border border-gray-300 px-3 py-2"},null,40,E),o.value&&s.value.length>0?(c(),d("ul",I,[(c(!0),d(A,null,C(s.value,(n,g)=>(c(),d("li",{key:n,onMousedown:F(N=>m(n),["prevent"]),class:D(["cursor-pointer px-3 py-2",{"bg-gray-100":g===t.value}])},O(n),43,M))),128))])):B("",!0)]))}};export{z as _};
