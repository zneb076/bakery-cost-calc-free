import{d as i,S as n}from"./sweetalert2.esm.all-BdfwKlh3.js";import{r as h,a as g,b as t,k as l,o as w}from"./index-WFeeEGVN.js";const b=[{name:"แป้งเค้ก",purchaseUnit:"กรัม",purchaseQuantity:1e3,purchasePrice:45,costPerGram:.045,id:1},{name:"น้ำตาลไอซิ่ง",purchaseUnit:"กรัม",purchaseQuantity:900,purchasePrice:50,costPerGram:.0555,id:2},{name:"เนยสดชนิดจืด",purchaseUnit:"กรัม",purchaseQuantity:227,purchasePrice:120,costPerGram:.5286,id:3},{name:"ไข่ไก่ (เบอร์ 1)",purchaseUnit:"ฟอง",purchaseQuantity:30,purchasePrice:130,costPerGram:.07222222222222222,id:4,defaultYield:100,costByWholeUnit:!0,standardWeightInGrams:60},{name:"นมสดรสจืด",purchaseUnit:"กรัม",purchaseQuantity:800,purchasePrice:50,costPerGram:.0625,id:5},{name:"ผงโกโก้",purchaseUnit:"กรัม",purchaseQuantity:200,purchasePrice:85,costPerGram:.425,id:6},{name:"ดาร์กช็อกโกแลต 70%",purchaseUnit:"กรัม",purchaseQuantity:500,purchasePrice:350,costPerGram:.7,id:7},{name:"กลิ่นวานิลลา",purchaseUnit:"ขวด",purchaseQuantity:1,purchasePrice:80,costPerGram:.8,id:8,defaultYield:"",standardWeightInGrams:100},{name:"นมผงฮอกไกโด",purchaseUnit:"กรัม",purchaseQuantity:480,purchasePrice:140,costPerGram:.2916666666666667,id:10},{name:"ยีสต์",purchaseUnit:"กรัม",purchaseQuantity:500,purchasePrice:140,costPerGram:.28,id:11},{name:"เกลือ",purchaseUnit:"กรัม",purchaseQuantity:1e3,purchasePrice:30,costPerGram:.03,id:12},{name:"วิป",purchaseUnit:"กรัม",purchaseQuantity:1e3,purchasePrice:240,costPerGram:.24,id:13},{name:"เนยจืด",purchaseUnit:"กรัม",purchaseQuantity:5e3,purchasePrice:1600,costPerGram:.32,id:14},{name:"น้ำร้อน",purchaseUnit:"กรัม",purchaseQuantity:600,purchasePrice:5,costPerGram:.008333333333333333,id:15},{name:"น้ำตาล",purchaseUnit:"กรัม",purchaseQuantity:1e3,purchasePrice:31,costPerGram:.031,id:16},{name:"น้ำมันพืช",purchaseUnit:"ลิตร",purchaseQuantity:1,purchasePrice:60,costPerGram:.06315789473684211,id:17},{name:"แป้งขนมปัง",purchaseUnit:"กรัม",purchaseQuantity:1e3,purchasePrice:40,defaultYield:100,costPerGram:.04,id:28},{name:"กล้วยหอม",purchaseUnit:"ลูก",purchaseQuantity:9,purchasePrice:100,defaultYield:"",standardWeightInGrams:80,costPerGram:.1388888888888889,id:29}],x=[{name:"ขนมปังไส้คัสตาร์ด (ตัวอย่าง)",isSubRecipe:!1,ingredientsList:[{itemType:"ingredient",itemId:28,quantity:150,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:16,quantity:20,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:11,quantity:2,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:12,quantity:2,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:5,quantity:30,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:4,quantity:20,yield:100,costByWholeUnit:!0},{itemType:"ingredient",itemId:14,quantity:20,yield:100,costByWholeUnit:!1},{itemType:"recipe",itemId:3,quantity:100,yield:100,costByWholeUnit:!1}],notes:"",id:2},{name:"ไส้คัสตาร์ด (ตัวอย่าง)",isSubRecipe:!0,ingredientsList:[{itemType:"ingredient",itemId:4,quantity:58,yield:100,costByWholeUnit:!0},{itemType:"ingredient",itemId:16,quantity:40,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:8,quantity:3,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:5,quantity:20,yield:100,costByWholeUnit:!1}],notes:"",id:3},{name:"เค้กกล้วยหอม (ตัวอย่าง)",isSubRecipe:!1,ingredientsList:[{itemType:"ingredient",itemId:1,quantity:200,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:4,quantity:130,yield:100,costByWholeUnit:!0},{itemType:"ingredient",itemId:16,quantity:40,yield:100,costByWholeUnit:!1},{itemType:"ingredient",itemId:12,quantity:5,yield:100,costByWholeUnit:!1}],notes:"",id:4}],U={class:"flex flex-col gap-8 md:flex-row"},B={class:"flex-grow"},P={class:"rounded-lg bg-white p-6 shadow-md"},I={class:"space-y-4"},W={__name:"SettingsDataView",setup(T){h("data");async function d(){try{const r=await i.ingredients.toArray(),e=await i.recipes.toArray(),a={version:i.verno,timestamp:new Date().toISOString(),data:{ingredients:r,recipes:e}},s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),o=document.createElement("a");o.href=URL.createObjectURL(s);const c=new Date().toISOString().slice(0,10);o.download=`backup-ขออีกคำ-คำนวนต้นทุน-${c}.json`,o.click(),URL.revokeObjectURL(o.href)}catch(r){console.error("Export failed:",r),n.fire("เกิดข้อผิดพลาด","ไม่สามารถส่งออกข้อมูลได้","error")}}function u(){document.getElementById("import-file-input").click()}async function p(r){const e=r.target.files[0];if(!e)return;const a=await e.text();try{const s=JSON.parse(a),o=m(s);(await n.fire({title:"คุณแน่ใจหรือไม่?",text:"การนำเข้าข้อมูลจะลบข้อมูลที่มีอยู่ทั้งหมดและแทนที่ด้วยข้อมูลจากไฟล์ Backup!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ใช่, นำเข้าเลย!",cancelButtonText:"ยกเลิก"})).isConfirmed&&(await i.transaction("rw",i.ingredients,i.recipes,async()=>{await i.ingredients.clear(),await i.recipes.clear(),await i.ingredients.bulkAdd(o.ingredients),await i.recipes.bulkAdd(o.recipes)}),await n.fire("สำเร็จ!","นำเข้าข้อมูลเรียบร้อยแล้ว","success"),window.location.reload())}catch(s){console.error("Import failed:",s),n.fire("เกิดข้อผิดพลาด","ไฟล์ Backup ไม่ถูกต้อง หรือเกิดปัญหาในการนำเข้า","error")}finally{r.target.value=""}}function m(r){let e=r.version||1,a=r.data;if(!a||!a.ingredients||!a.recipes)throw new Error("Invalid backup file structure");return e<4&&(a.recipes.forEach(s=>{s.ingredientsList&&Array.isArray(s.ingredientsList)}),e=4),console.log(`Data migrated from v${r.version} to v${e}`),a}async function y(){if((await n.fire({title:"โหลดข้อมูลตัวอย่าง?",text:"การกระทำนี้จะลบข้อมูลวัตถุดิบและสูตรทั้งหมดที่มีอยู่ แล้วแทนที่ด้วยข้อมูลตัวอย่าง",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ใช่, โหลดเลย!",cancelButtonText:"ยกเลิก"})).isConfirmed)try{await i.transaction("rw",i.ingredients,i.recipes,async()=>{await i.ingredients.clear(),await i.recipes.clear(),await i.ingredients.bulkAdd(b),await i.recipes.bulkAdd(x)}),await n.fire("สำเร็จ!","โหลดข้อมูลตัวอย่างเรียบร้อยแล้ว","success"),window.location.reload()}catch(e){console.error("Failed to load sample data:",e),n.fire("เกิดข้อผิดพลาด","ไม่สามารถโหลดข้อมูลตัวอย่างได้","error")}}async function f(){const{value:r}=await n.fire({title:"คุณแน่ใจจริงๆ หรือไม่?",html:`
      การกระทำนี้จะลบข้อมูล **วัตถุดิบและสูตรทั้งหมด** อย่างถาวรและไม่สามารถกู้คืนได้!
      <br><br>
      เพื่อยืนยัน โปรดพิมพ์คำว่า <strong>ลบทั้งหมด</strong> ลงในช่องด้านล่าง
    `,icon:"warning",input:"text",inputPlaceholder:"พิมพ์ ลบทั้งหมด ที่นี่",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ยืนยันการลบ",cancelButtonText:"ยกเลิก",preConfirm:e=>e!=="ลบทั้งหมด"?(n.showValidationMessage("ข้อความยืนยันไม่ถูกต้อง"),!1):!0});if(r)try{await i.transaction("rw",i.ingredients,i.recipes,async()=>{await i.ingredients.clear(),await i.recipes.clear()}),await n.fire("สำเร็จ!","ข้อมูลทั้งหมดถูกลบเรียบร้อยแล้ว","success"),window.location.reload()}catch(e){console.error("Failed to delete all data:",e),n.fire("เกิดข้อผิดพลาด","ไม่สามารถลบข้อมูลได้","error")}}return(r,e)=>(w(),g("div",null,[t("div",U,[t("main",B,[t("div",P,[e[11]||(e[11]=t("h2",{class:"mb-4 text-2xl font-semibold"},"สำรองและนำเข้าข้อมูล",-1)),t("div",I,[t("div",null,[e[0]||(e[0]=t("h3",{class:"font-semibold"},"สำรองข้อมูล (Backup)",-1)),e[1]||(e[1]=t("p",{class:"mb-2 text-sm text-gray-500"}," บันทึกข้อมูลวัตถุดิบและสูตรทั้งหมดของคุณเป็นไฟล์ `.json` ",-1)),t("button",{onClick:d,class:"rounded-lg bg-secondary px-4 py-2 font-bold text-white"}," สำรองข้อมูล ")]),e[8]||(e[8]=t("hr",null,null,-1)),t("div",null,[e[2]||(e[2]=t("h3",{class:"font-semibold"},"นำเข้าข้อมูล (Restore)",-1)),e[3]||(e[3]=t("p",{class:"mb-2 text-sm text-gray-500"},[t("span",{class:"font-bold text-red-500"},"คำเตือน:"),l(" การนำเข้าข้อมูลจะลบข้อมูลปัจจุบันทั้งหมดทิ้ง ")],-1)),t("button",{onClick:u,class:"rounded-lg border border-primary px-4 py-2 font-bold text-primary"}," นำเข้าข้อมูล "),t("input",{type:"file",id:"import-file-input",onChange:p,class:"hidden",accept:".json"},null,32)]),e[9]||(e[9]=t("hr",null,null,-1)),t("div",null,[e[4]||(e[4]=t("h3",{class:"font-semibold"},"ข้อมูลตัวอย่าง",-1)),e[5]||(e[5]=t("p",{class:"mb-2 text-sm text-gray-500"},[t("span",{class:"font-bold text-red-500"},"คำเตือน:"),l(" หากมีข้อมูลอยู่แล้ว ข้อมูลทั้งหมดจะถูกลบและแทนที่ด้วยข้อมูลเริ่มต้น ")],-1)),t("button",{onClick:y,class:"rounded-lg border border-yellow-500 px-4 py-2 font-bold text-yellow-600"}," โหลดข้อมูลตัวอย่าง ")]),e[10]||(e[10]=t("hr",null,null,-1)),t("div",null,[e[6]||(e[6]=t("h3",{class:"font-semibold text-red-600"}," ลบข้อมูลทั้งหมด (การกระทำที่ไม่สามารถย้อนกลับได้) ",-1)),e[7]||(e[7]=t("p",{class:"mb-2 text-sm text-gray-500"}," ล้างข้อมูลวัตถุดิบและสูตรทั้งหมดในฐานข้อมูลของคุณเพื่อเริ่มต้นใหม่ทั้งหมด ",-1)),t("button",{onClick:f,class:"rounded-lg bg-red-600 px-4 py-2 font-bold text-white"}," ลบข้อมูลทั้งหมด ")])])])])])]))}};export{W as default};
